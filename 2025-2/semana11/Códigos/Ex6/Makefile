# ==========================================================
# Makefile - Ex6
# =========================================================

# 1Ô∏è‚É£ Vari√°veis (para facilitar manuten√ß√£o)
CFLAGS=-O0 -std=c11 -Wall -Werror -Wextra -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wshadow -fsanitize=address,undefined,leak 
CLIBS=-lm
LDFLAGS = -fsanitize=address,undefined,leak # Flags usadas no linking (geram o execut√°vel)
EXECUTAVEL=Ex6.exe # nome do execut√°vel final

# ==========================================================
# 2Ô∏è‚É£ Alvo principal (primeiro alvo ‚Üí padr√£o ao rodar "make")
# ==========================================================

all: $(EXECUTAVEL)

$(EXECUTAVEL): main.o Arvore.o No.o Util.o
	@echo "üîß Ligando objetos e gerando execut√°vel..."
	@gcc main.o Arvore.o No.o Util.o $(CLIBS) $(LDFLAGS) -o $(EXECUTAVEL)
	@echo "‚úÖ Compila√ß√£o conclu√≠da."
	@echo "üöÄ Para executar o programa digite ./$(EXECUTAVEL) no terminal."

# ==========================================================
# 3Ô∏è‚É£ Regras para gerar os arquivos objeto
# ==========================================================

main.o: main.c
	@echo "üß© Compilando main.c"
	@gcc $(CFLAGS) -c main.c

Arvore.o: Arvore.c
	@echo "üß© Compilando Arvore.c"
	@gcc $(CFLAGS) -c Arvore.c

No.o: No.c
	@echo "üß© Compilando No.c"
	@gcc $(CFLAGS) -c No.c

Util.o: Util.c
	@echo "üß© Compilando Util.c"
	@gcc $(CFLAGS) -c Util.c

# ==========================================================
# 4Ô∏è‚É£ Alvos auxiliares (n√£o geram arquivos ‚Üí PHONY)
# ==========================================================

.PHONY: clean run

# Limpa os arquivos tempor√°rios
clean: 
	@echo "üßπ Limpando arquivos compilados..."
	@rm -rf *.o $(EXECUTAVEL)
	@echo "üßº Diret√≥rio limpo!"
	
# Executa o programa (compila antes se necess√°rio)
run: $(EXECUTAVEL)
	@echo "üöÄ Executando o programa com o arquivo 'Entrada1.txt':"
	./$(EXECUTAVEL) < Entrada1.txt
	@echo ""
	@echo "üöÄ Executando o programa com o arquivo 'Entrada2.txt':"
	./$(EXECUTAVEL) < Entrada2.txt
	@echo ""
	@echo "üöÄ Executando o programa com o arquivo 'Entrada3.txt':"
	./$(EXECUTAVEL) < Entrada3.txt


